<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Making Visualizations Literally with Svelte & D3 | Connor Rothschild</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="site"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="site"><meta data-n-head="ssr" data-hid="description" name="description" content="Why Svelte has replaced (and complemented) D3 as my go-to tool for powerful visualizations"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="article"><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://v3.connorrothschild.com/post/svelte-and-d3"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="Making Visualizations Literally with Svelte & D3"><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="Why Svelte has replaced (and complemented) D3 as my go-to tool for powerful visualizations"><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://v3.connorrothschild.com/post/svelte-and-d3/header.png"><meta data-n-head="ssr" data-hid="twitter:url" name="twitter:url" content="https://v3.connorrothschild.com/post/svelte-and-d3"><meta data-n-head="ssr" data-hid="twitter:title" name="twitter:title" content="Making Visualizations Literally with Svelte & D3"><meta data-n-head="ssr" data-hid="twitter:description" name="twitter:description" content="Why Svelte has replaced (and complemented) D3 as my go-to tool for powerful visualizations"><meta data-n-head="ssr" data-hid="twitter:image" name="twitter:image" content="https://v3.connorrothschild.com/post/svelte-and-d3/header.png"><meta data-n-head="ssr" data-hid="twitter:site" name="twitter:site" content="@CL_Rothschild"><meta data-n-head="ssr" data-hid="twitter:card" name="twitter:card" content="summary_large_image"><meta data-n-head="ssr" property="article:published_time" content="2021-12-16T21:41:20.940Z"><meta data-n-head="ssr" property="article:modified_time" content="2021-12-16T21:41:20.940Z"><meta data-n-head="ssr" name="twitter:label1" content="Written by"><meta data-n-head="ssr" name="twitter:data1" content="Connor Rothschild"><base href="/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.png"><link data-n-head="ssr" data-hid="shortcut-icon" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.ecd1ba.png"><link data-n-head="ssr" data-hid="apple-touch-icon" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.ecd1ba.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.d23946e6.json" data-hid="manifest"><link data-n-head="ssr" data-hid="canonical" rel="canonical" href="https://v3.connorrothschild.com/post/svelte-and-d3"><link rel="preload" href="/_nuxt/64b5898.js" as="script"><link rel="preload" href="/_nuxt/cbfb02f.js" as="script"><link rel="preload" href="/_nuxt/css/0e51f67.css" as="style"><link rel="preload" href="/_nuxt/7e4b2d1.js" as="script"><link rel="preload" href="/_nuxt/css/2510a47.css" as="style"><link rel="preload" href="/_nuxt/2bd4311.js" as="script"><link rel="preload" href="/_nuxt/css/2d74e3a.css" as="style"><link rel="preload" href="/_nuxt/c4401d5.js" as="script"><link rel="preload" href="/_nuxt/2c17e43.js" as="script"><link rel="preload" href="/_nuxt/css/ff4f90e.css" as="style"><link rel="preload" href="/_nuxt/e8925e5.js" as="script"><link rel="preload" href="/_nuxt/css/71314a7.css" as="style"><link rel="preload" href="/_nuxt/0dd4b09.js" as="script"><link rel="stylesheet" href="/_nuxt/css/0e51f67.css"><link rel="stylesheet" href="/_nuxt/css/2510a47.css"><link rel="stylesheet" href="/_nuxt/css/2d74e3a.css"><link rel="stylesheet" href="/_nuxt/css/ff4f90e.css"><link rel="stylesheet" href="/_nuxt/css/71314a7.css"><link rel="preload" href="/_nuxt/static/1639691221/post/svelte-and-d3/state.js" as="script"><link rel="preload" href="/_nuxt/static/1639691221/post/svelte-and-d3/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1639691221/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div class="theme-primary-off"><nav role="navigation" aria-label="main navigation" class="navbar theme-primary" data-v-577d5465><div class="navbar-brand" data-v-577d5465><a href="/" class="navbar-item has-text-weight-boldest nuxt-link-active" data-v-577d5465>Connor Rothschild
    </a> <a role="button" aria-label="menu" aria-expanded="false" data-target="navbarID" class="navbar-burger" data-v-577d5465><span aria-hidden="true" data-v-577d5465></span> <span aria-hidden="true" data-v-577d5465></span> <span aria-hidden="true" data-v-577d5465></span></a></div> <div id="navbarID" class="navbar-menu" data-v-577d5465><div class="navbar-end" data-v-577d5465><div class="navbar-item" data-v-577d5465><div class="themepicker__btn" data-v-15133967 data-v-577d5465><span class="themepicker__palette" data-v-15133967><span class="themepicker__swatch themepicker__swatch--primary" data-v-15133967></span> <span class="themepicker__swatch themepicker__swatch--secondary" data-v-15133967></span> <span class="themepicker__swatch themepicker__swatch--text" data-v-15133967></span></span></div></div> <a href="/#projects" class="navbar-item" data-v-577d5465>
        Projects
      </a> <a href="/#awards" class="navbar-item" data-v-577d5465>
        Awards
      </a> <a href="/#blog" class="navbar-item" data-v-577d5465>
        Blog
      </a> <a href="mailto:connor@connorrothschild.com" class="navbar-item" data-v-577d5465>
        Email
      </a> <a href="https://docs.google.com/document/d/1qBH-wNMe2nv9Xa4uzHZ5wBevohwKuB3h2i9M2yk4POk/edit?usp=sharing" target="_blank" rel="noopener" class="navbar-item" data-v-577d5465>
        Resume
      </a></div></div></nav> <article class="section container is-max-tablet"><h1 class="my-3 has-text-weight-boldest content-title is-size-3-mobile">
      Making Visualizations Literally with Svelte & D3
    </h1> <p class="my-3 content-description is-size-5-mobile">
      Why Svelte has replaced (and complemented) D3 as my go-to tool for powerful visualizations
    </p> <p class="heading is-size-6 has-text-weight-light">
      July 2021 ‚Ä¢
      <span>11 minute read
  <!----></span></p> <hr> <div class="nuxt-content"><style>html{scroll-behavior:smooth}svg{width:100%;margin:.5rem 0 1.5rem 0;box-shadow:2px 2px 5px 1px rgb(var(--primary-off));border-radius:6px}rect{width:100%;height:100%;fill:rgb(var(--primary),.5)}circle{cursor:crosshair}</style>
<p>When I started making data visualizations, I considered <a href="https://d3js.org/" rel="nofollow noopener noreferrer" target="_blank">D3</a>‚ÄîData Driven Documents‚Äîto be the gold standard programming language required to create beautiful graphics on the web.</p>
<p>As I progress in my career, I'm realizing that D3 has a more particular (and smaller) role in the visualization lifecycle than I initially envisioned. As I design more visualizations, I'm learning that my most efficient and intuitive development comes when I <strong>program literally</strong>.</p>
<p>What does that mean? (To be honest, I'm making up the term.) It means that I'm moving away from <em>pseudo-declarative</em> data visualization in D3, and starting to make my visualizations <em>literally</em>, by simply writing markup in <a href="https://svelte.dev/" rel="nofollow noopener noreferrer" target="_blank">Svelte</a>.</p>
<p>Although D3 <a href="https://d3js.org/#selections" rel="nofollow noopener noreferrer" target="_blank">claims</a> to be declarative, it still uses <a href="https://www.carlosrendon.me/unfinished_d3_book/d3_method_chaining.html" rel="nofollow noopener noreferrer" target="_blank">method chaining</a> to provide instructions to render visuals. In Svelte, we don't provide instructions but instead render our SVG elements directly, using <code>{#each}</code> blocks. By writing my markup literally and appending data inline, my code makes more sense and causes fewer headaches.</p>
<h4 id="what-youll-find-in-this-post"><a href="#what-youll-find-in-this-post" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>What you'll find in this post</h4>
<p>In this post, I'll <a href="#what-d3-does-3%EF%B8%8F%E2%83%A3">1)</a> provide an overview of D3, and how it made the process of creating visualizations so much easier; <a href="#literal-programming-with-svelte-">2)</a> explain why I'm moving away from D3 for DOM manipulation, and instead using Svelte "literally"; and <a href="#bringing-it-home-with-burgers-">3)</a> provide a funky burger üçî example to explain my logic.</p>
<div class="p-4 my-3 info-box" data-v-66ffdc8b><div data-v-66ffdc8b>
<p data-v-66ffdc8b>This is not a comprehensive tutorial about <strong data-v-66ffdc8b>how to</strong> use D3 and Svelte together. I'll cover that in the <a href="https://twitter.com/CL_Rothschild" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>future</a>. In the meantime, check out tutorials from <a href="https://www.youtube.com/watch?v=bnd64ZrHC0U" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>Matthias Stahl</a>, examples of Svelte and D3 in action on The Pudding's <a href="https://github.com/the-pudding/" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>GitHub</a>, and an example of similar framework-driven logic on Amelia Wattenberger's <a href="https://wattenberger.com/blog/react-and-d3" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>blog</a>.</p>
<p data-v-66ffdc8b>Want an immediate example? Here's an (admittedly verbose) <a href="https://github.com/connorrothschild/bob-ross-art-gallery/blob/master/src/components/ColorViz.svelte" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>Svelte component</a> I used in a recent project about Bob Ross.</p>
  </div></div>
<h2 id="what-d3-does-3Ô∏è‚É£"><a href="#what-d3-does-3%EF%B8%8F%E2%83%A3" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>What D3 does 3Ô∏è‚É£</h2>
<p>D3 allows for intuitive transformations of the DOM by leveraging easy-to-understand selection syntax. Sound confusing? Let's learn through an example (adapted from the <a href="https://d3js.org/#selections" rel="nofollow noopener noreferrer" target="_blank">D3 homepage</a>). Imagine we had 5 circles and wanted to change the fill of each.</p>
<svg>
  <rect width="100%" height="100%"></rect>
  <circle cx="10%" cy="50%" r="10" fill="steelblue"><title>Hello from the circle!</title></circle>
  <circle cx="30%" cy="50%" r="10" fill="steelblue"><title>Hello from the circle!</title></circle>
  <circle cx="50%" cy="50%" r="10" fill="steelblue"><title>Hello from the circle!</title></circle>
  <circle cx="70%" cy="50%" r="10" fill="steelblue"><title>Hello from the circle!</title></circle>
  <circle cx="90%" cy="50%" r="10" fill="steelblue"><title>Hello from the circle!</title></circle>
</svg>
<p>In the traditional <a href="https://www.w3schools.com/js/js_htmldom.asp" rel="nofollow noopener noreferrer" target="_blank">HTML DOM model</a>, we would 1) select all circles, 2) loop through each one, and 3) redefine its fill. In code, that would look like this:</p>
<div class="nuxt-content-highlight"><span class="filename">file.js</span><pre class="line-numbers language-js"><code><span class="token keyword">var</span> circles <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"circle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> circles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> circle <span class="token operator">=</span> circles<span class="token punctuation">.</span><span class="token method function property-access">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  circle<span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token string">"fill"</span><span class="token punctuation">,</span> <span class="token string">"white"</span><span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Doing this in D3 would reduce the length of our code by a factor of 5, and allows us to write in a way that <em>just makes sense</em>. Here, we select every circle and change its fill.</p>
<div class="nuxt-content-highlight"><span class="filename">fileWithD3.js</span><pre class="line-numbers language-js"><code>d3<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">"circle"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">style</span><span class="token punctuation">(</span><span class="token string">"fill"</span><span class="token punctuation">,</span> <span class="token string">"white"</span><span class="token punctuation">)</span>
</code></pre></div>
<svg>
  <rect width="100%" height="100%"></rect>
  <circle cx="10%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="30%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="50%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="70%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="90%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
</svg>
<p>Imagine if you also wanted to bind data to those circles. That is, you wanted to fill the circle according to some attribute, or size its radius according to some datapoint. In traditional JavaScript, that might look something like this:</p>
<div class="nuxt-content-highlight"><span class="filename">file.js</span><pre class="line-numbers language-js"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> circles <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"circle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> circles<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> circle <span class="token operator">=</span> circles<span class="token punctuation">.</span><span class="token method function property-access">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  circle<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token method function property-access">setProperty</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Not too hard‚Äîbut also, not too easy. D3 simplifies this logic by removing the need for a loop and iterating on your selection for you:</p>
<div class="nuxt-content-highlight"><span class="filename">fileWithD3.js</span><pre class="line-numbers language-js"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

d3<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">"circle"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token arrow operator">=></span> d<span class="token punctuation">)</span>
</code></pre></div>
<svg>
  <rect width="100%" height="100%"></rect>
  <circle cx="10%" cy="50%" r="5" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="30%" cy="50%" r="10" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="50%" cy="50%" r="15" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="70%" cy="50%" r="20" fill="white"><title>Hello from the circle!</title></circle>
  <circle cx="90%" cy="50%" r="25" fill="white"><title>Hello from the circle!</title></circle>
</svg>
<p>Again, we reduce the length of our code nearly 5x, and the code just <strong>makes sense</strong>.</p>
<p>All that to say, D3 is great. It works, and it works wonderfully. By removing the need to write highly imperative code that is unintuitive in nature, D3 saves developers time and allows for more powerful visualizations.</p>
<p>But I'm hardly using it at all recently. Increasingly, I've been using the JavaScript <del>framework</del> compiler <a href="https://svelte.dev/" rel="nofollow noopener noreferrer" target="_blank">Svelte</a> to <em>write SVG directly</em> rather than <em>tell JavaScript to write SVG</em>. How? Let's see below.</p>
<h2 id="literal-programming-with-svelte-"><a href="#literal-programming-with-svelte-" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>"Literal" programming with Svelte üó£</h2>
<p>Going back to the above circles, imagine if we could simply bind our data to our app's markup <strong>directly</strong>, without any intermediate code serving as instructions.</p>
<p><strong>We can!</strong> Svelte (and Vue, React and other frameworks) allow for seamless interactions between our app's logic, data, and markup, so that we can embed data directly into our SVG elements. In this new paradigm, we could replace the set of D3 instructions from earlier with the following Svelte code:</p>
<div class="nuxt-content-highlight"><span class="filename">Component.svelte</span><pre class="line-numbers language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token plain-text">
  let data = [{x: 10, r: 5 }, 
              {x: 30, r: 10}, 
              {x: 50, r: 15}, 
              {x: 70, r: 20}, 
              {x: 90, r: 25}]
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span>#each data <span class="token keyword module">as</span> d<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>d<span class="token punctuation">.</span><span class="token property-access">x</span> <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">}</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>d<span class="token punctuation">.</span><span class="token property-access">r</span><span class="token punctuation">}</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>white<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span>
</code></pre></div>
<svg>
  <rect width="100%" height="100%"></rect>
  <circle cx="10%" cy="50%" r="5" fill="white"><title>Hello from the circle with a radius of 5!</title></circle>
  <circle cx="30%" cy="50%" r="10" fill="white"><title>Hello from the circle with a radius of 10!</title></circle>
  <circle cx="50%" cy="50%" r="15" fill="white"><title>Hello from the circle with a radius of 15!</title></circle>
  <circle cx="70%" cy="50%" r="20" fill="white"><title>Hello from the circle with a radius of 20!</title></circle>
  <circle cx="90%" cy="50%" r="25" fill="white"><title>Hello from the circle with a radius of 25!</title></circle>
</svg>
<p>In my view, there are three benefits to writing our code this way:</p>
<ol>
<li><strong>More intuitive authoring.</strong> It feels much more natural to write our SVG elements <em>directly</em> rather than provide D3 instructions on how to do so.</li>
<li><strong>Less friction in translating D3 to the DOM.</strong> By writing SVG directly, we could copy an SVG element from the <a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/circle" rel="nofollow noopener noreferrer" target="_blank">MDN docs</a>, paste in our values, and see immediate results. Fewer handoffs results in fewer errors.</li>
<li><strong>Reusability.</strong> Creating a robust and flexible <code>&lt;Circle /></code>, <code>&lt;Bar /></code>, or <code>&lt;Axis /></code> component permits consistent reuse within and across projects. D3 code is usually written as a series of blocks which lacks a natural structure and becomes difficult to reuse effectively.</li>
</ol>
<p>The only downside (which is actually just an adjustment) is that this new approach requires you to learn how to <a href="https://www.w3schools.com/graphics/svg_intro.asp" rel="nofollow noopener noreferrer" target="_blank">write SVG</a>. But isn't it a good exercise to learn the anatomy of what we're actually creating? Having knowledge of SVG elements and attributes will benefit any developer who creates visuals, no matter how they eventually do so.</p>
<p>Not convinced? Let me explain the logic one more time, with a tastier example:</p>
<h2 id="bringing-it-home-with-burgers-"><a href="#bringing-it-home-with-burgers-" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Bringing it home with burgers üçî</h2>
<p>Imagine we want to prepare a burger. We have an array of objects, each with an ingredient and ingredient-specfic instructions. We want to 1) create each item (insert it into the DOM), and 2) carry out its instructions (execute some function).</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code><span class="token keyword">let</span> ingredients <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Top Bun"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Place at top of burger."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Pickles"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Three pickles, please."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Cheese"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Cheese is optional, but it makes the burger better."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Patty"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Cook to your satisfaction. Optionally, add two patties."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Tomato"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Should be the same width as bun, and thinly sliced."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Lettuce"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Should be the same width as bun."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>item<span class="token operator">:</span> <span class="token string">"Bottom Bun"</span><span class="token punctuation">,</span> instruction<span class="token operator">:</span> <span class="token string">"Place at bottom of burger."</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div>
<p>There are three ways to make this burger (at least, in our fantasy world where we make burgers via code).</p>
<div class="p-4 my-3 info-box" data-v-66ffdc8b><div data-v-66ffdc8b>
<p data-v-66ffdc8b>Although I use the Svelte REPL to showcase these three examples, only the last one requires Svelte. The REPL is just a nice place to host (editable!) code üôÇ</p>
  </div></div>
<p><strong>The first option</strong> (old school) is to tell your app to loop through each ingredient, add it to the others, and stack the ingredients accordingly. For each ingredient in the loop, execute the burger-making according to our ingredient-specific instruction. This is how burgers would have been made, painfully, before D3.</p>
<iframe src="https://svelte.dev/repl/4b4eee03981b4450aa08e402aa0ceeb6?version=3.38.3" width="100%" height="600" title="Old school burger building"></iframe>
<p><strong>The second option</strong> (new school) is to tell your app to read in each ingredient and instruction through D3 method chaining. We remove the need for our verbose <code>for</code> loop, and use the chain to give D3 a set of sequential instructions.</p>
<iframe src="https://svelte.dev/repl/8198de15de314aee860932629370ed09?version=3.38.3" width="100%" height="600" title="New school burger building"></iframe>
<p><strong>Our final option</strong> (new new school), we can simply append our instructions directly to the ingredient, <em>literally</em>. Here, we skip <code>for</code> loops and we skip D3 method chaining; instead, we componentize our general "burger item" and pass each ingredient/instruction directly to that component. Only Svelte enables such burgers:</p>
<iframe src="https://svelte.dev/repl/f64bd9dcface42a1a2d544b35638631e?version=3" width="100%" height="600" title="Literal burger building"></iframe>
<p>Which do you prefer? It's much easier to make a burger by <em>just making it</em>, rather than giving instructions, no matter what form they come in. Frameworks allow for the construction of burgers‚Äîand visualizations‚Äî<strong>literally</strong>. We write our ingredients (or DOM elements) directly, and include our instructions (or data) in our markup. Now that's a tasty burger.</p>
<h2 id="the-big-picture-"><a href="#the-big-picture-" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>The big picture üñº</h2>
<ol>
<li>Svelte allows visualization developers to <strong>write SVG directly</strong> (and avoid telling D3 what to do), while using Svelte syntax (<code>{#each}</code>, etc.) to avoid annoying and inefficient <code>for</code> loops.</li>
<li>Including logic directly in your markup (<code>{#if}</code>, etc.) removes the need for complex JavaScript/DOM interactions (more on that below).</li>
<li>Svelte works to <em>complement</em> D3, not replace it, by continuing to leverage the most powerful parts of its API: <code>d3-scale</code>, <code>d3-array</code>, <code>d3-shape</code>, etc.</li>
</ol>
<hr>
<h2 id="bonus-perks-"><a href="#bonus-perks-" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Bonus perks üèÜ</h2>
<p>Using Svelte to create visualizations has a few other perks:</p>
<h3 id="responsiveness"><a href="#responsiveness" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Responsiveness</h3>
<p>By using Svelte's <a href="https://svelte.dev/tutorial/reactive-declarations" rel="nofollow noopener noreferrer" target="_blank">reactive declarations</a> (the dollar signs üí∞), we can make certain variables  'watch' for state changes and update automatically. One huge benefit of this is that we can bind our scales to updating values such as the window width, and write minimal code to make our charts update on resize.</p>
<div class="nuxt-content-highlight"><span class="filename">Component.svelte</span><pre class="line-numbers language-jsx"><code><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> windowWidth <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"../stores/store.js"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> scaleLinear <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'d3-scale'</span><span class="token punctuation">;</span>

$<span class="token operator">:</span> xScale <span class="token operator">=</span> scaleLinear
            <span class="token punctuation">.</span><span class="token method function property-access">domain</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">d</span> <span class="token arrow operator">=></span> d<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token method function property-access">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> $windowWidth<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div>
<p>With some other component watching and responding to resize events (such as <a href="https://github.com/the-pudding/svelte-starter/blob/master/src/components/helpers/Window.svelte" rel="nofollow noopener noreferrer" target="_blank">Window.svelte</a>), any SVG property depending on <code>xScale</code> will automatically update when your window resizes. You can also set the chart width itself to equal <code>$windowWidth</code> for a fully resizable, responsive chart.</p>
<div class="p-4 my-3 info-box" data-v-66ffdc8b><div data-v-66ffdc8b>
<p data-v-66ffdc8b>Another way to achieve easy responsiveness is to <a href="https://svelte.dev/tutorial/dimensions" rel="nofollow noopener noreferrer" target="_blank" data-v-66ffdc8b>bind the SVG's parent container's div width</a> to some variable (<code data-v-66ffdc8b>width</code>) and set the SVG's width to match.</p>
  </div></div>
<h3 id="ifelse-blocks"><a href="#ifelse-blocks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>If/else blocks</h3>
<p>In regular D3, we often use the <a href="https://en.wikipedia.org/wiki/%3F:" rel="nofollow noopener noreferrer" target="_blank">ternary operator</a> to define condition-specific attributes, like this:</p>
<div class="nuxt-content-highlight"><span class="filename">fileWithD3.js</span><pre class="line-numbers language-js"><code><span class="token comment">// Circles are filled green if positive, red if negative</span>
d3<span class="token punctuation">.</span><span class="token method function property-access">selectAll</span><span class="token punctuation">(</span><span class="token string">'circle'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token method function property-access">style</span><span class="token punctuation">(</span><span class="token string">'fill'</span><span class="token punctuation">,</span> <span class="token parameter">d</span> <span class="token arrow operator">=></span> d<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">'red'</span> <span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">)</span>
</code></pre></div>
<p>This is great, but what if we want to make more significant changes based on app-wide state? For example, imagine we want to show three different types of the same visualization on different screen sizes:</p>
<ol>
<li>Desktop (> 1024px)</li>
<li>Tablet (520px to 1024px)</li>
<li>Mobile (&lt; 520px)</li>
</ol>
<p>In D3, we would achieve this by adding a resize event listener, providing custom breakpoints, and rendering different visuals if the updated window width were within a certain range. The complicated part would be having to render a different visual at each breakpoint.</p>
<p>One key difference between relying on D3 and leveraging the power of Svelte is that Svelte allows for <a href="https://svelte.dev/tutorial/if-blocks" rel="nofollow noopener noreferrer" target="_blank">conditional rendering</a> <em>directly in our markup</em>, not just in our JavaScript logic. In other words, while vanilla JavaScript would approach our problem with the following:</p>
<div class="nuxt-content-highlight"><span class="filename">file.js</span><pre class="line-numbers language-js"><code><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> newWidth <span class="token operator">=</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">innerWidth</span><span class="token punctuation">;</span>

    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>newWidth <span class="token operator">&lt;</span> <span class="token number">520</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
      <span class="token comment">// Hide tablet and desktop</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"tablet"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"desktop"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>

      <span class="token comment">// Show mobile</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"mobile"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>newWidth <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Hide mobile and desktop</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"mobile"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"desktop"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>

      <span class="token comment">// Show tablet</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"tablet"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Hide mobile and tablet</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"mobile"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"tablet"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>

      <span class="token comment">// Show desktop</span>
      <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"desktop"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Svelte simplifies our logic to:</p>
<div class="nuxt-content-highlight"><span class="filename">RandomComponent.svelte</span><pre class="line-numbers language-jsx"><code><span class="token punctuation">{</span>#<span class="token keyword control-flow">if</span> $windowWidth <span class="token operator">&lt;</span> <span class="token number">520</span><span class="token punctuation">}</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mobile</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">{</span><span class="token operator">:</span><span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> $windowWidth <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">}</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Tablet</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">{</span><span class="token operator">:</span><span class="token keyword control-flow">else</span><span class="token punctuation">}</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Desktop</span></span> <span class="token punctuation">/></span></span>
<span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword control-flow">if</span><span class="token punctuation">}</span>
</code></pre></div>
<br>
<p>Hey, thanks for reading. I appreciate you! In the event that you disagree with me or I got something wrong, please message me on <a href="https://twitter.com/CL_Rothschild" rel="nofollow noopener noreferrer" target="_blank">Twitter</a>.</p></div> <hr> <div class="my-4"><a href="/post" class="subtitle has-text-weight-bolder is-size-5 link heading is-inline-block nuxt-link-active">üëà Back to all posts</a></div> <div class="columns"><div class="column"><!----></div> <div class="column"><div style="height:100%;transition:1s transform ease;transform:translateX(0) translateY(0)"><a href="/post/flat-data-r"><article class="card card-fullheight has-background-semitransparent"><div class="card-image"><figure class="image is-2by1"><img src="//:0" alt="Blog post header image" class="v-lazy-image object-fit-cover" data-v-14ae8593></figure></div> <div class="card-content"><div class="content is-flex is-justify-content-space-evenly"><div class="has-text-centered"><p class="heading title is-size-6">Previous post</p> <p class="has-text-weight-light title is-size-6">
                Including R in your Flat Data Workflow
              </p></div></div></div></article></a> <!----></div></div></div></article> <footer class="site-footer" data-v-37cbb2b5><div class="content has-text-centered site-footer-content" data-v-37cbb2b5><p data-v-37cbb2b5>
      Built with üíö and Nuxt.js by
      <a href="https://twitter.com/CL_Rothschild" target="_blank" rel="noopener noreferrer" class="link" data-v-37cbb2b5>Connor Rothschild</a>. The source code is available on
      <a href="https://github.com/connorrothschild/v3" target="_blank" rel="noopener noreferrer" class="link" data-v-37cbb2b5>GitHub</a>.
    </p></div></footer></div></div></div></div><script defer src="/_nuxt/static/1639691221/post/svelte-and-d3/state.js"></script><script src="/_nuxt/64b5898.js" defer></script><script src="/_nuxt/c4401d5.js" defer></script><script src="/_nuxt/2c17e43.js" defer></script><script src="/_nuxt/e8925e5.js" defer></script><script src="/_nuxt/0dd4b09.js" defer></script><script src="/_nuxt/cbfb02f.js" defer></script><script src="/_nuxt/7e4b2d1.js" defer></script><script src="/_nuxt/2bd4311.js" defer></script>
  </body>
</html>
